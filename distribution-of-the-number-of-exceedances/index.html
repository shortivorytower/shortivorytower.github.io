<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Distribution of the Number of Exceedances - Short Ivory Tower</title>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P3RGW6V');</script>
<!-- End Google Tag Manager -->


  <!-- Edit site and author settings in `_config.yml` to make the social details your own -->

    <meta content="Short Ivory Tower" property="og:site_name">
  
    <meta content="Distribution of the Number of Exceedances" property="og:title">
  
  
    <meta content="article" property="og:type">
  
  
    <meta content="This blog is a place for me to write down technical stuff that I found interesting. 
" property="og:description">
  
  
    <meta content="/distribution-of-the-number-of-exceedances/" property="og:url">
  
  
    <meta content="2018-03-16T00:00:00+08:00" property="article:published_time">
    <meta content="/about/" property="article:author">
  
  
    <meta content="/assets/img/hk-add-oil.jpg" property="og:image">
  
  
    
  
  
    
    <meta content="Statistics" property="article:tag">
    
  

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@">
    <meta name="twitter:creator" content="@">
  
    <meta name="twitter:title" content="Distribution of the Number of Exceedances">
  
  
    <meta name="twitter:url" content="/distribution-of-the-number-of-exceedances/">
  
  
    <meta name="twitter:description" content="This blog is a place for me to write down technical stuff that I found interesting. 
">
  
  
    <meta name="twitter:image:src" content="/assets/img/hk-add-oil.jpg">
  

	<meta name="description" content="">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta property="og:image" content="">
	<link rel="shortcut icon" href="/assets/img/favicon/favicon.ico" type="image/x-icon">
	<link rel="apple-touch-icon" href="/assets/img/favicon/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicon/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicon/apple-touch-icon-144x144.png">
	<!-- Chrome, Firefox OS and Opera -->
	<meta name="theme-color" content="#263959">
	<!-- Windows Phone -->
	<meta name="msapplication-navbutton-color" content="#263959">
	<!-- iOS Safari -->
	<meta name="apple-mobile-web-app-status-bar-style" content="#263959">
	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=PT+Serif:400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="/assets/fonts/font-awesome/css/font-awesome.min.css">
	<!-- Styles -->
	<link rel="stylesheet" href="/assets/css/main.css">
</head>

<body>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P3RGW6V"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


  <div class="wrapper">
    <aside class="sidebar">
  <header>
    <div class="about">
      <div class="cover-author-image">
        <a href="/"><img src="/assets/img/hk-add-oil.jpg" alt="Short Ivory Tower"></a>
      </div>
      <div class="author-name">Short Ivory Tower</div>
      <p>This blog is a notepad to write down technical stuff that I found interesting.</p>
    </div>
  </header> <!-- End Header -->
  <footer>
    <section class="contact">
      <h3 class="contact-title">Contact me</h3>
      <ul>
        
	<!--
          <li><a href="https://twitter.com/artemsheludko_" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
	-->
        
        
	<!--
          <li><a href="https://facebook.com/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
	-->
        
        
          <li class="github"><a href="http://github.com/shortivorytower" target="_blank"><i class="fa fa-github"></i></a></li>
        
        
	<!--
          <li class="linkedin"><a href="https://in.linkedin.com/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
	-->
        
        
	<!--
          <li class="email"><a href="mailto:example.david@blog.com"><i class="fa fa-envelope-o" aria-hidden="true"></i></a></li>
	-->
        
      </ul>
    </section> <!-- End Section Contact -->
    <div class="copyright">
      <p>2019 &copy; Short Ivory Tower</p>
    </div>
  </footer> <!-- End Footer -->
</aside> <!-- End Sidebar -->
<div class="content-box clearfix">
  <article class="article-page">
  <div class="page-content">
    
    
    <div class="wrap-content">
      <header class="header-page">
        <h1 class="page-title">Distribution of the Number of Exceedances</h1>
        <div class="page-date"><span>2018, Mar 16&nbsp;&nbsp;&nbsp;&nbsp;</span></div>
      </header>
      <script type="text/x-mathjax-config">
MathJax.Hub.Config({
                  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
                          });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<p>I am reading an <a href="http://www.springer.com/us/book/9783764372309">Extreme Value Analysis</a> book. The first topic is understanding the distribution of the number of exceedances. I tried implementing some python scripts to help reading the book. Even though it is just elementary statistics, the exercise provides some insight to me.</p>

<p>The question is that given a random variable <script type="math/tex">X</script>, a threshold <script type="math/tex">u</script> and the total number of trials <script type="math/tex">n</script>, what is the distribution of the number of times that the outcome of <script type="math/tex">X</script> is greater than or equal to <script type="math/tex">u</script>?</p>

<p>Let’s say we have <script type="math/tex">n</script> i.i.d. random variables <script type="math/tex">X_1, X_2, ... X_n</script> with a cdf <script type="math/tex">F(x) = \Pr (X \leq x)</script></p>

<p>The probability <script type="math/tex">p</script> of an observation that’s over the threshold <script type="math/tex">u</script> is,</p>

<script type="math/tex; mode=display">\begin{align*}
p  = \Pr (X \gt u) \\
 = 1 - F(u)
\end{align*}</script>

<p>Let <script type="math/tex">K</script> be the number of times in <script type="math/tex">n</script> trials that <script type="math/tex">X_i \gt u</script>, i.e. the number of exceedances</p>

<script type="math/tex; mode=display">K = \sum_{i=1}^{n} I(X_i \gt u)</script>

<p>Then <script type="math/tex">K</script> simply follows the binomial distribution of <script type="math/tex">n</script> and <script type="math/tex">p</script>,</p>

<script type="math/tex; mode=display">\Pr (K = k) = B_{n,p}(k) = \binom{n}{k}p^k(1-p)^{n-k}</script>

<p>Since the analysis is about extreme value, thus <script type="math/tex">p</script> is small and <script type="math/tex">n</script> is reasonably large. In this case, the binomial distribution can be approximated by a Poisson distribution <script type="math/tex">P_{\lambda}(k) = \frac{\lambda^k}{k!}e^{-\lambda}</script>  for <script type="math/tex">\lambda = np</script>, with this inequality,</p>

<script type="math/tex; mode=display">\lvert B_{n,p}(k) - P_{np}(k) \rvert \leq p</script>

<p>Here let’s plot the two PMFs of <script type="math/tex">n = 200</script> trials on <script type="math/tex">X \sim \Gamma(2.5, 1)</script> with a threshold <script type="math/tex">u = 6.5</script>,</p>

<noscript><pre>400: Invalid request
</pre></noscript>
<script src="https://gist.github.com/d4991aa26433da3f82b4b532d3ac13b8.js"> </script>

<p><img src="/assets/img/extreme-value-theory/evt-figure-1.png" alt="Figure 1" class="img-responsive" /></p>

<p>We may also want to know the threshold <script type="math/tex">u_T</script> such that over <script type="math/tex">T</script> sequential trials we expect to have exactly one exceedance.</p>

<p>That’s called T-Year Level.</p>

<p>Here each observation is i.i.d. We can treat them as <script type="math/tex">T</script> independent observations / trials, each follows the cdf <script type="math/tex">F(x)</script>. That is,</p>

<script type="math/tex; mode=display">K_T = \sum_{i=1}^{T} I(X_i \gt u_T) \\

\begin{align*}

E(K_T) = \sum_{i=1}^{T} E\Big[I(X_i \gt u_T)\Big] = 1\\
\\
\text{since all } X_i \text{ are i.i.d.} \\
\\
T \Pr(X \gt u_T) = 1 \\
T \Big[ 1 - F(u_T) \Big] = 1 \\
F(u_T) = 1 - \frac{1}{T} \\
u_T = F^{-1}\Big(1 - \frac{1}{T}\Big) \\

\end{align*}</script>

<p>Thus the threshold <script type="math/tex">u_T</script> is simply the <script type="math/tex">1-1/T</script> quantile of the distribution <script type="math/tex">F</script>.</p>

<p>The plot of the T-Year Level <script type="math/tex">u_T</script> against the number of observations <script type="math/tex">T</script>,</p>

<noscript><pre>400: Invalid request
</pre></noscript>
<script src="https://gist.github.com/e6c542af666b07428c81bb9a88be751d.js"> </script>

<p><img src="/assets/img/extreme-value-theory/evt-figure-2.png" alt="Figure 2" class="img-responsive" /></p>

<p>Some thoughts,</p>

<ul>
  <li>The distribution of the number of exceedances depends only on the number of trials <script type="math/tex">n</script> and and the probability of exceedance <script type="math/tex">p</script>.</li>
  <li>If we have a fairly accurate estimate of <script type="math/tex">p</script>, the actual underlying distribution of <script type="math/tex">X</script> is actually irrelevant. i.e. We don’t need to know <script type="math/tex">F(x)</script> if we have <script type="math/tex">p</script></li>
  <li>But in the actual world, it is very difficult to have enough data to estimate <script type="math/tex">p</script>. Instead if we have a domain expert, or have a good fit of existing data to a distribution <script type="math/tex">F(x)</script> we can have some analytical estimates on the number of exceedances, even if we don’t have any extreme data points over the threshold <script type="math/tex">u</script></li>
  <li>On the other hand the T-Year Level <script type="math/tex">u_T</script> depends on the underlying distribution <script type="math/tex">F(x)</script></li>
  <li><script type="math/tex">u_T</script> is increasing along the number of trials <script type="math/tex">T</script>. It is because the more trials we have, the larger <script type="math/tex">u_T</script> has to be so that the expected number of exceedances being exactly 1.</li>
</ul>


      <div class="page-footer">
        <div class="page-share">
          <a href="https://twitter.com/intent/tweet?text=Distribution of the Number of Exceedances&url=/distribution-of-the-number-of-exceedances/" title="Share on Twitter" rel="nofollow" target="_blank">Twitter</a>
          <a href="https://facebook.com/sharer.php?u=/distribution-of-the-number-of-exceedances/" title="Share on Facebook" rel="nofollow" target="_blank">Facebook</a>
          <a href="https://plus.google.com/share?url=/distribution-of-the-number-of-exceedances/" title="Share on Google+" rel="nofollow" target="_blank">Google+</a>
        </div>
        <div class="page-tag">
          
            <a href="/tags#Statistics" class="tag">&#35; Statistics</a>
          
        </div>
      </div>
      <section class="comment-area">
  <div class="comment-wrapper">
    
    <div id="disqus_thread" class="article-comments"></div>
    <script>
      (function() {
          var d = document, s = d.createElement('script');
          s.src = '//shortivorytower.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
  </div>
</section> <!-- End Comment Area -->

    </div> <!-- End Wrap Content -->
  </div> <!-- End Page Content -->
</article> <!-- End Article Page -->

</div>

  </div>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', '', 'auto');
  ga('send', 'pageview');
</script> <!-- End Analytics -->

</body>
</html>
